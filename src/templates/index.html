<!-- templates/index.html -->
{% extends "base.html" %}

{% block content %}

<div class="row">
  <!-- 왼쪽: 부상 빈도수 차트 -->
  <div class="col-md-6 mb-3">
    <div class="card">
      <div class="card-header">
        가장 흔한 부상 TOP5
      </div>
      <div class="card-body">
        <canvas id="injuryChart" height="200"></canvas>
      </div>
    </div>
  </div>

  <!-- 오른쪽: 스포츠-부상 상위 빈도 리스트 (예시) -->
  <div class="col-md-6 mb-3">
    <div class="card">
      <div class="card-header">
        스포츠별 부상 통계
      </div>
      <div class="card-body">
        <ul class="list-group">
          {% for row in sportInjuryList %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            {{ row.sport }} - {{ row.injury }}
            <span class="badge bg-primary rounded-pill">{{ row.count }}</span>
          </li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</div>

<!-- 차트 데이터 (injuries) -->
<script>
  // Flask에서 넘겨준 데이터 예: injuryChartData = [{name: "탈구", count: 10}, {name: "통증", count: 8}, ...]
  const injuryData = JSON.parse('{{ injuryChartData|tojson|safe }}');

  // Chart.js로 바 차트 그리기
  const ctx = document.getElementById('injuryChart');
  const labels = injuryData.map(item => item.name);
  const counts = injuryData.map(item => item.count);

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: labels,
      datasets: [{
        label: '부상 발생 빈도',
        data: counts,
        backgroundColor: 'rgba(255, 99, 132, 0.6)',
      }]
    },
    options: {
      scales: {
        y: { beginAtZero: true }
      }
    }
  });
</script>

{% endblock %}